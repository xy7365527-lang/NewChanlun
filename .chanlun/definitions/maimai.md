# 买卖点（MaiMai / Buy-Sell Points）

**版本**: v0.1
**状态**: 生成态
**最后更新**: 2026-02-16
**原文依据**: 第17课（第一、二类买卖点首次提出）、第20课（第三类买卖点）、第21课（完备性定理）

---

## 原文谱系

买卖点概念在缠师108课中的演化历程：

### 第17课 (2006-12-18) — 走势终完美：第一、二类买卖点首次提出

> "对于下跌的走势来说，一旦完成，只能转化为上涨与盘整，因此，一旦能把握下跌走势转化的关节点买入，就在市场中占据了一个最有利的位置，而这个买点，就是前面反复强调的'第一类买点'。"

> "因为上涨和盘整必然要在图形上完成，而上涨和盘整在图形上的要求，是必须包含三个以上的次级别运动，因此后面必须还至少有一个向上的次级别运动，这样的买点是绝对安全的，其安全性由走势的'不患'而保证，这，就是在前面反复强调的第二类买点。"

> "缠中说禅买卖点定律一：任何级别的第二类买卖点都由次级别相应走势的第一类买点构成。"

> "缠中说禅趋势转折定律：任何级别的上涨转折都是由某级别的第一类卖点构成的；任何的下跌转折都是由某级别的第一类买点构成的。"

**要点**：
- 第一类买点 = 下跌走势完成的转折点
- 第二类买点 = 第一类买点后第一次次级别回调的低点
- 安全性来源：走势终完美原理保证后面至少还有一个向上的次级别运动
- 买卖点定律一：二类买卖点本质上是次级别的一类买卖点
- 趋势转折定律：所有转折最终由某级别的一类买卖点构成

### 第20课 (2007-01-05) — 中枢级别扩张与第三类买卖点

> "由定理一，可以得到第三类买卖点定理：一个次级别走势类型向上离开缠中说禅走势中枢，然后以一个次级别走势类型回试，其低点不跌破ZG，则构成第三类买点；一个次级别走势类型向下离开缠中说禅走势中枢，然后以一个次级别走势类型回抽，其高点不升破ZD，则构成第三类卖点。"

> "第三类买卖点比第一、二类要后知后觉，但如果抓得好，往往不用浪费盘整的时间，比较适合短线技术较好的资金，但一定要注意，并不是任何回调回抽都是第三类买卖点，必须是第一次。"

> "第三类买卖点后，并不必然是趋势，也有进入更大级别盘整的可能，但这种买卖之所以必然赢利，就是因为即使是盘整，也会有高点出现。"

**要点**：
- 第三类买点 = 次级别离开中枢后，次级别回试不跌破ZG
- 第三类卖点 = 次级别离开中枢后，次级别回抽不升破ZD
- 必须是第一次离开后的回试/回抽
- 第三类买卖点后有两种可能：趋势新生 或 更大级别中枢扩张
- 但无论哪种情况，只要条件符合，其后都必然赢利

### 第21课 (2007-01-09) — 买卖点分析的完备性

> "缠中说禅买卖点的完备性定理：市场必然产生赢利的买卖点，只有第一、二、三类。"

> "缠中说禅升跌完备性定理：市场中的任何向上与下跌，都必然从三类缠中说禅买卖点中的某一类开始以及结束。换言之，市场走势完全由这样的线段构成，线段的端点是某级别三类缠中说禅买卖点中的某一类。"

> "只有在下跌确立后的中枢下方才可能出现买点。这就是第一类买点。"

> "第二类买点是和第一类买点紧密相连的，因为出现第一类买点后，必然只会出现盘整与上涨的走势类型，而第一买点出现后的第二段次级别走势低点就构成第二类买点，根据走势必完美的原则，其后必然有第三段向上的次级别走势出现，因此该买点也是绝对安全的。"

> "一个上涨趋势确定后，不可能再有第一类与第二类买点，只可能有第三类买点。"

> "只有第二类买点与第三类买点是可能产生重合的，这种情况就是：第一类买点出现后，一个次级别的走势凌厉地直接上破前面下跌的最后一个中枢，然后在其上产生一个次级别的回抽不触及该中枢，这时候，就会出现第二类买点与第三类买点重合的情况。"

**要点**：
- 完备性定理：三类买卖点穷尽了所有必然赢利的买卖机会
- 升跌完备性：市场所有运动的起止点都是某级别的某类买卖点
- 第一类买点只可能出现在下跌确立后的中枢下方
- 上涨趋势确定后只有第三类买点
- 第一类与第二类不可能重合，第一类与第三类不可能重合
- 第二类与第三类可以重合（V型反转情形）

### 编纂版要点补充（`docs/chanlun/text/chan99/0025-第四节 走势中枢与买卖点.md`）

> "第一类买点：某级别下跌趋势中，一个次级别走势类型向下跌破最后一个走势中枢后形成的背驰点。"

> "第一类卖点：某级别上涨趋势中，一个次级别走势类型向上突破最后一个走势中枢后形成的背驰点。"

> "第二类买点：某级别中，第一类买点的次级别上涨结束后再次下跌的那个次级别走势的结束点。"

> "第二类卖点：某级别中，第一类卖点的次级别下跌结束后再次上涨的那个次级别走势的结束点。"

> "第三类买点：某级别上涨趋势中，一个次级别走势类型向上离开走势中枢，然后以一个次级别走势类型回抽，其低点不跌破走势中枢上边缘ZG的走势中枢终结点。"

> "第三类卖点：某级别下跌趋势中，一个次级别走势类型向下离开走势中枢，然后以一个次级别走势类型回抽，其高点不升破走势中枢下边缘ZD的走势中枢终结点。"

**要点**：
- 编纂版给出了更凝练的定义表述
- 第一类买卖点明确关联"背驰点"
- 第三类买卖点明确关联ZG/ZD中枢边缘
- ⚠️ 注意：编纂版是第三方编纂，原始博文为最终权威

### 谱系小结

| 阶段 | 课号 | 核心内容 | 性质 |
|------|------|----------|------|
| 首次提出 | 第17课 | 第一、二类买卖点、买卖点定律一、趋势转折定律 | 概念奠基 |
| 第三类 | 第20课 | 第三类买卖点定理、中枢离开回试条件 | 概念补完 |
| 完备性 | 第21课 | 买卖点完备性定理、升跌完备性定理、买卖点互斥/重合关系 | 理论封闭 |

---

## 定义

### 核心定义

#### 第一类买点（First Buy Point / 1B）
某级别**下跌趋势**中，一个次级别走势类型向下跌破**最后一个走势中枢**后形成的**背驰点**。

- **前提条件**：必须在下跌趋势确立后（≥2个依次向下的同级别中枢）
- **触发机制**：趋势最后一段次级别走势发生背驰（力度弱于前段同向走势）
- **安全性保证**：走势终完美原理 → 下跌完成后只能转为上涨或盘整

#### 第一类卖点（First Sell Point / 1S）
某级别**上涨趋势**中，一个次级别走势类型向上突破**最后一个走势中枢**后形成的**背驰点**。

- **前提条件**：必须在上涨趋势确立后（≥2个依次向上的同级别中枢）
- **触发机制**：趋势最后一段次级别走势发生背驰
- **安全性保证**：走势终完美原理 → 上涨完成后只能转为下跌或盘整

#### 第二类买点（Second Buy Point / 2B）
某级别中，第一类买点出现后，次级别上涨结束后**再次下跌**的那个次级别走势的**结束点**。

- **前提条件**：第一类买点已出现
- **安全性保证**：第一类买点后必然出现盘整或上涨 → 走势至少包含3段次级别运动 → 后面必然至少还有一个向上的次级别运动
- **位置关系**：可出现在中枢上方、中枢内或中枢下方
  - 中枢上方 → 中枢新生机会大（强势）
  - 中枢内 → 中枢扩张与新生对半
  - 中枢下方 → 出现扩张性中枢可能性大（弱势）

#### 第二类卖点（Second Sell Point / 2S）
某级别中，第一类卖点出现后，次级别下跌结束后**再次上涨**的那个次级别走势的**结束点**。

- **前提条件**：第一类卖点已出现
- **安全性保证**：对称于第二类买点

#### 第三类买点（Third Buy Point / 3B）
一个次级别走势类型向上**离开**缠中说禅走势中枢，然后以一个次级别走势类型**回试**，其低点**不跌破ZG**（中枢上边缘），则构成第三类买点。

- **前提条件**：
  1. 必须是**第一次**离开后的回试（非第二次、第三次…）
  2. 离开段和回试段都必须是完成的次级别走势类型
- **安全性保证**：
  - 回试不跌破ZG → 中枢被有效突破
  - 其后必然出现：趋势新生（新中枢） 或 更大级别中枢扩张
  - 无论哪种情况，短期内必然有高点出现 → 赢利
- **注意**：第三类买卖点后不必然是趋势，可能是更大级别盘整

#### 第三类卖点（Third Sell Point / 3S）
一个次级别走势类型向下**离开**缠中说禅走势中枢，然后以一个次级别走势类型**回抽**，其高点**不升破ZD**（中枢下边缘），则构成第三类卖点。

- **前提条件**：对称于第三类买点
- **安全性保证**：对称于第三类买点

### 关键定理

#### 买卖点定律一
> 任何级别的第二类买卖点都由次级别相应走势的第一类买点构成。

**推论**：所有买卖点归根结底都可以归结到不同级别的第一类买卖点。

#### 趋势转折定律
> 任何级别的上涨转折都是由某级别的第一类卖点构成的；任何的下跌转折都是由某级别的第一类买点构成的。

**注意**：这里的"某级别"不一定是次级别，因为次级别里可以是第二类买卖点；也可能出现不同级别同时第一类买卖点（多级别共振）。

#### 买卖点完备性定理
> 市场必然产生赢利的买卖点，只有第一、二、三类。

#### 升跌完备性定理
> 市场中的任何向上与下跌，都必然从三类缠中说禅买卖点中的某一类开始以及结束。

### 买卖点互斥/重合关系

| 买点对 | 是否可能重合 | 说明 |
|--------|-------------|------|
| 1B 与 2B | **不可能** | 时间上前后出现 |
| 1B 与 3B | **不可能** | 1B在中枢下方，3B在中枢上方 |
| 2B 与 3B | **可以重合** | 当1B后凌厉上破最后一个中枢、且回抽不触及该中枢时 |

卖点的互斥/重合关系对称。

### 买卖点与走势类型的约束

| 走势状态 | 可能的买点类型 | 说明 |
|----------|--------------|------|
| 下跌趋势进行中 | 无买点 | 下跌未完成 |
| 下跌趋势背驰 | 1B | 下跌走势完成 |
| 1B后第一次回调 | 2B | 走势完美保证后续上涨 |
| 上涨趋势确立后 | 仅3B | 不可能再有1B、2B |
| 盘整中 | 中枢下不必然有买点 | 盘整中枢下方不保证安全 |

---

## 当前实现

### 代码现状
- **买卖点模块**：⚠️ **尚未实现**（0%代码覆盖）
- **相关已实现模块**：
  - `src/newchan/a_divergence.py` — 背驰判断（第一类买卖点的触发条件）
    - `Divergence` 数据类：`kind`（trend/consolidation）、`direction`（top/bottom）、`force_a/force_c`
    - `divergences_from_level()` — 检测某递归层级的所有背驰
    - `_detect_trend_divergence()` — 趋势背驰检测
    - `_detect_consolidation_divergence()` — 盘整背驰检测
  - `src/newchan/a_move_v1.py` — 走势类型实例（`Move`数据类）
  - `src/newchan/a_zhongshu_v1.py` — 中枢（`Center`/`Zhongshu`数据类）

### 实现路径建议
1. **第一类买卖点**：复用 `Divergence(kind="trend")` + 走势类型完成判定
2. **第二类买卖点**：在第一类买卖点后，定位第一个次级别回调/反弹的结束点
3. **第三类买卖点**：中枢离开段 + 回试段 + ZG/ZD比较

---

## 边界条件

### 正常情况
1. **三类买卖点穷尽所有必然赢利的买卖机会**（完备性定理）
2. **所有市场运动的起止点都是某级别某类买卖点**（升跌完备性定理）
3. **每个走势类型的结束必然对应某级别的第一类买卖点**（趋势转折定律）

### 边界/特殊情况
1. **2B与3B重合（V型反转）**：第一类买点后凌厉上破+回抽不触及中枢 → 往往对应大级别上涨
2. **盘整中的假买点**：盘整中枢下方的反弹不一定是安全买点（盘整可向下扩张/新生）
3. **小级别转大级别**：当小级别背驰未触及大级别买卖点时，需要第二类买卖点补充
4. **第三类买卖点仅限第一次**：后续的离开-回试不构成第三类买卖点
5. **上涨趋势中无1B/2B**：一旦上涨确立，只可能有3B（趋势延续中的中枢突破）
6. **多级别共振**：不同级别同时出现第一类买卖点，信号强度最大，但缺乏形式化定义

---

## 未结算问题

### 1. 下跌确立条件的精确定义
- **问题**：第一类买点的前提是"下跌确立"。下跌确立的精确条件是什么？
  - 原文定义：≥2个依次向下的同级别中枢 = 下跌趋势
  - 但第21课说"只有在下跌确立后的中枢下方才可能出现买点"
  - 那么：1个中枢的下跌盘整后再下跌（即还未确立为趋势时）能否产生第一类买点？
- **影响**：决定了第一类买点的识别时机。如果必须等≥2中枢才算"下跌确立"，则会错过某些转折
- **原文线索**：第17课 "一旦能把握下跌走势转化的关节点买入" — 强调的是"走势转化"而非"趋势确立"
- **可能的分歧**：
  - 严格口径：只有下跌趋势（≥2中枢）的最后一段背驰才算1B
  - 宽松口径：盘整后的下跌背驰也算某种形式的1B（但原文说盘整中枢下不必然产生买点）

### 2. 买卖点与走势类型完成的映射关系
- **问题**：买卖点的出现与走势类型完成的关系尚需精确化
  - 第一类买卖点 = 走势类型完成点？还是走势类型完成后的某个时点？
  - 背驰点出现时走势是否已"完成"？（背驰是完成的充分条件还是必要条件？）
- **影响**：决定了买卖点在走势状态机中的精确位置
- **关联问题**：zoushi.md 未结算问题 #1（背驰判断与走势完成的关系）

### 3. 买卖点的确认时机
- **问题**：买卖点何时从"候选"变为"确认"？
  - 第一类买点：背驰点出现时即确认？还是需要后续次级别走势类型完成？
  - 第二类买点：次级别回调结束后才能确认，但"结束"的判定本身也需要背驰/走势完成
  - 第三类买点：回试段完成且低点>ZG时确认，但回试段何时算"完成"？
- **影响**：实时交易中，确认时机的延迟直接影响入场价格和风险
- **与 Divergence.confirmed 的关系**：背驰模块已有 `confirmed: bool` 字段，但语义需要对齐

### 4. 盘整背驰与买卖点的关系
- **问题**：盘整背驰（`Divergence(kind="consolidation")`）产生的是什么类型的买卖点？
  - 原文明确区分"趋势背驰"和"盘整背驰"
  - 第一类买卖点定义中说"下跌趋势中"的背驰点 → 排除了盘整背驰
  - 但盘整背驰在实战中是常见的操作信号
- **影响**：盘整背驰对应的操作点不在三类买卖点体系中，或者说属于中枢震荡的操作（非买卖点）
- **原文线索**：编纂版 "总体围绕走势中枢的操作原则：每次向下离开走势中枢只要出现底背驰，那就可以介入了"

### 5. 第三类买卖点的中枢范围
- **问题**：第三类买卖点的ZG/ZD是指哪个中枢？
  - 原文第20课："一个次级别走势类型向上离开缠中说禅走势中枢" — 这个中枢是当前走势中最后一个？还是特指某个？
  - 如果存在中枢延伸（中枢震荡多次），ZG/ZD的定义是初始中枢还是延伸后的？
- **影响**：中枢定义使用ZG=min(g1,g2)、ZD=max(d1,d2)（前三段确定），延伸不改变ZG/ZD
- **关联**：zhongshu.md 中枢定义

---

## 依赖定义

### 直接依赖
1. **走势类型（`.chanlun/definitions/zoushi.md`）** — 核心依赖
   - 第一类买卖点需要走势类型的完成判定
   - 第三类买卖点需要走势类型对应中枢的离开/回试判定
   - 买卖点与走势类型的约束关系（如上涨中只有3B）
2. **中枢（`.chanlun/definitions/zhongshu.md`）** — 核心依赖
   - 第一类买卖点需要中枢的最后一个中枢判定
   - 第三类买卖点需要中枢的ZG/ZD边缘
   - 中枢延伸/新生/扩张决定第三类买卖点后的走势
3. **背驰（`.chanlun/definitions/beichi.md` v0.1 生成态，代码实现于 `src/newchan/a_divergence.py`）** — 核心依赖
   - 第一类买卖点的触发条件 = 趋势背驰
   - 背驰的力度判断（MACD面积 / 价格振幅）

### 间接依赖
4. **线段（`.chanlun/definitions/xianduan.md`）** — 次级别走势的来源
5. **笔（`.chanlun/definitions/bi.md`）** — 更底层构造
6. **分型（`.chanlun/definitions/fenxing.md`）** — 底层构造
7. **包含关系（`.chanlun/definitions/baohan.md`）** — 底层基础

---

## 谱系引用

### 相关谱系记录
1. **`.chanlun/genealogy/pending/001-degenerate-segment.md`** — 退化线段问题
   - 影响：退化线段可能导致次级别走势判定异常，进而影响买卖点识别
2. **`.chanlun/genealogy/settled/002-source-incompleteness.md`** — 原文不完整性（已结算）
   - 影响：编纂版定义表述可能与原始博文有差异
3. **`.chanlun/genealogy/pending/004-provenance-framework.md`** — 概念溯源框架
   - 影响：买卖点定义中ZG/ZD来自第20课原文定义
4. **`.chanlun/genealogy/pending/005-object-negation-principle.md`** — 对象否定对象原则
   - 影响：走势完成（第一类买卖点的前提）必须由走势内部机制否定，不允许外部条件
5. **不确定是否有其他相关谱系** — 买卖点作为新创建的定义，尚无直接对应的谱系条目

---

## 影响声明

### 影响的模块
1. **买卖点模块（尚未实现）** — 本定义文件的直接下游
2. **`src/newchan/a_divergence.py`** — 背驰判断（第一类买卖点的触发条件）
   - 当前已实现 `Divergence` 数据类和检测函数
   - 买卖点模块需复用其输出
3. **`src/newchan/a_move_v1.py`** — 走势类型实例
   - 走势类型的完成状态（`settled: bool`）影响第一类买卖点的识别
4. **`src/newchan/a_zhongshu_v1.py`** — 中枢
   - 中枢的ZG/ZD是第三类买卖点的判定基准
5. **`src/newchan/core/recursion/`** — 递归引擎
   - 买卖点识别需要在递归引擎中集成

### 影响的定义
1. **走势类型定义 zoushi.md** — 买卖点定义填补了其未结算问题 #2（买卖点与走势类型的精确对应）
2. **中枢定义 zhongshu.md** — 中枢破坏条件（定理三）与第三类买卖点的关系需要交叉引用
3. **背驰定义 beichi.md v0.1** — 背驰与第一类买卖点的触发关系需要在两个定义文件中保持一致

### 下游推论
1. **操作策略**：
   - 第一类买卖点 → 趋势反转点，最大利润但需要背驰判断能力
   - 第二类买卖点 → 趋势确认点，安全性由走势完美保证
   - 第三类买卖点 → 趋势延续/中枢突破点，不浪费盘整时间
   - 2B+3B重合 → V型反转，往往对应大级别上涨
2. **风险管理**：
   - 每类买点后如果出现卖点必须执行（"宁愿卖错，绝对不能买错"）
   - 第一类卖点是趋势反转的确定信号
   - 第三类卖点是最后的逃命线
3. **代码架构**：
   - 买卖点识别器应作为管道的最后一环
   - 输入依赖：Move（走势类型）、Center/Zhongshu（中枢）、Divergence（背驰）
   - 输出：BuySellPoint 实例列表
   - 应支持增量计算（diff模式）

---

## 结论

买卖点定义是缠论操作系统中从理论到实操的桥梁。三类买卖点的完备性定理保证了它们穷尽了所有必然赢利的交易机会。

**当前状态**：
- **定义**：已从原文提取核心定义和定理，初步完成形式化
- **实现**：代码 0% 覆盖，是走势类型审计发现的最严重缺口
- **状态**：**生成态** — 原因：
  1. 5个未结算问题需要解决（下跌确立条件、走势完成映射、确认时机、盘整背驰、中枢范围）
  2. ~~依赖的背驰定义文件尚未创建~~ → ✅ beichi.md v0.1 已创建
  3. 需要与 zoushi.md、zhongshu.md 的未结算问题交叉结算

**下一步**：
1. ~~创建背驰定义文件~~ → ✅ 已完成（beichi.md v0.1）
2. 解决未结算问题 #1（下跌确立条件），可能需要矛盾上浮
3. 设计买卖点数据结构和识别算法（`docs/spec/maimai_rules_v1.md`）
4. 实现买卖点识别器（TDD流程）

**变更历史**：
- v0.1 (2026-02-16)：初始草案，从原文提取三类买卖点定义和完备性定理，识别5个未结算问题
