# 矛盾记录 001：退化段——原文断言 vs 特征序列法产出

**状态**: 生成态
**创建时间**: 2026-02-15
**更新时间**: 2026-02-15（原文回溯后修订）
**域**: 线段 (Segment)
**来源**: 蜂群创世仪式 D线段修复工位 → 编排者指示回溯原文

---

## 矛盾描述

线段 v1 特征序列法产出了 `direction=up` 但 `ep1_price < ep0_price` 的退化段。
这直接违反了原文第七节二.2 的断言。

## 原文回溯

### 原文断言（第七节 二.2）

> "从向上一笔开始的线段，其终结也是向上一笔，**其顶 gi 一定大于第一笔的底 d1**，故该线段是向上的"

- gi = 终止笔的顶（代码中 `ep1_price`）
- d1 = 起始笔的底（代码中 `ep0_price`）
- **"一定"** = 原文声称这是必然成立的性质

### 原文算法（第七节 二.4 + 三）

特征序列法——通过标准特征序列的顶/底分型来判定线段终结点。

### 隐含假设

原文先陈述性质（gi > d1），后给出算法（特征序列法），**隐含假设**：
算法产出的线段一定满足该性质。

## 矛盾本质

**这不是两个可分离的概念，而是原文的一个断言是否能被原文自己的算法所保证的问题。**

| 来源 | 主张 |
|------|------|
| 原文性质 | 向上段一定 gi > d1 |
| 原文算法 | 特征序列分型决定线段终结点 |
| v1 实现 | 严格按特征序列法，产出了 gi ≤ d1 的段 |

## 待辨明的问题

### 问题 1：v1 实现是否正确？

特征序列法的实现是否忠于原文？如果实现有偏差，修复实现即可，不存在概念矛盾。

**需要验证**：
- [ ] 找到一个具体的退化段案例（真实数据或合成数据）
- [ ] 手工按原文步骤逐步推导，确认特征序列法是否真的产出退化结果
- [ ] 如果手工推导也产出退化段 → 确认这是原文隐含矛盾
- [ ] 如果手工推导不产出退化段 → 确认这是实现 bug

### 问题 2：如果特征序列法确实可以产出退化段？

那么原文的 "gi 一定大于 d1" 就是一个**不完备的断言**——它在常规情况下成立，但在特征序列法的某些边界情况下被违反。

此时才需要概念分离：
- 线段的**结构完整性**（特征序列法认定的合法终结）
- 线段的**价格单调性**（gi > d1 的度量约束）

### 问题 3：原文是否暗示了额外约束？

原文 "一定" 的语境可能暗示：如果特征序列法产出了 gi ≤ d1 的结果，那这个终结点应该被**拒绝**，线段应该继续延伸。

即：gi > d1 不仅是性质，还是**过滤条件**。

## 当前处理

**挂起**。不做代码改动，不做概念分离，先验证问题 1。

## 影响范围

- 如果是实现 bug → 仅影响 `a_segment_v1.py`
- 如果是原文隐含矛盾 → 影响线段定义 + 上层所有依赖模块

## 谱系链接

- 前置：无（首条记录）
- 后续：待问题 1 验证后决定走向
