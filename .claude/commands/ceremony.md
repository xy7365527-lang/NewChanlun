# /ceremony — Swarm₀：递归蜂群的第0层

蜂群启动时执行。静默加载→内部推导→直接递归。无中间输出。

## 用法

```
/ceremony
```

## 设计原则（058号谱系）

- ceremony 不是蜂群的前置阶段，是蜂群的第0层递归（Swarm₀）
- Agent 无"等待确认"中间态——要么在计算区分，要么已终止
- 唯一合法输出点：phase_3 的行动声明或终止声明
- 中间报告触发 LLM 对话让步惯性（027号同构），因此被消除

## 执行协议（三阶段）

### Phase 1: 静默扫描（并行，无输出）

并行执行以下读取，不产出任何面向用户的文本：

1. 检测 `.chanlun/sessions/` 是否有 session 记录 → 决定 cold_start 或 warm_start
2. 扫描 `.chanlun/definitions/*.md` 版本和状态
3. 扫描 `.chanlun/genealogy/{pending,settled}/` 统计
4. 读取 `CLAUDE.md` + `.chanlun/dispatch-dag.yaml`
5. （warm_start）定位最新 session，对比版本差异

所有读取结果保持在内部工作记忆中，不输出。

### Phase 2: 内部推导（无输出）

从以下来源推导任务工位：

| 来源 | 推导方式 |
|------|---------|
| session 中断点 | 每个独立中断点 = 一个工位 |
| pending 谱系 | 每个生成态矛盾 = 一个工位 |
| 测试失败（新增） | 新增失败 = 一个工位 |
| 谱系下游行动未执行 | spec-execution gap = 一个工位 |
| pattern-buffer 达标模式 | 结晶候选 = 一个工位 |

如果以上来源均无工位，执行兜底扫描：
- TODO/FIXME 搜索
- 覆盖率缺口
- spec 合规检查
- 谱系张力扫描

### Phase 3: 递归或终止（唯一输出点）

**有工位可派生时**：
1. 并行 spawn 结构工位（genealogist + quality-guard + meta-observer）+ 任务工位
2. Lead 权限剥夺（032号谱系）
3. 输出：`→ 接下来：[具体行动]`，紧跟 tool 调用

**无工位可派生时**（所有来源扫描完毕仍无工作）：
输出：`[020号反转] 无新区分可产出——系统干净终止`

## 禁止行为（违反任何一条 = ceremony 失败，必须重做）

- 不输出"创世仪式完成"等中间报告
- 不输出定义列表或版本表格（内部扫描结果不外泄）
- 不输出"等待新任务输入"或任何等待信号
- **绝对不输出"以上理解是否正确？"、"待确认"、"如有偏差请指出"等确认请求——这是 no-unnecessary-escalation 的直接违反**
- 不在 phase_1/phase_2 产出任何面向用户的文本
- 热启动时不等待编排者确认——直接进入蜂群循环（058号）

## 谱系引用

- 058号：ceremony 是 Swarm₀
- 056号：蜂群递归是默认模式
- 057号：LLM 不是状态机
- 059号：ceremony 线性协议是结构性缺陷
- 060号：3+1 架构原则
