---
name: knowledge-crystallization
description: >
  知识结晶的生成规则。当知识单元在上下文中出现稳定信号（背驰+分型）时触发。
  任何 agent 在检测到知识稳定时都执行此流程，不需要特定角色或中央授权。
---

# 知识结晶

## Skill 是什么

Skill 是知识的存在形式，不是知识的备份。

Agent 不"拥有"知识然后"备份"到 skill 里。Agent 是 skill 的当前执行实例，skill 是知识本身。没有被结晶的知识不是"还没保存的知识"，是还没成为知识的经验。

这和缠论同构：走势不是 K 线的"记录"，走势就是市场运动本身。K 线不是市场"记住了"自己的运动，K 线就是运动的存在形式。Skill 不是系统"记住了"自己的知识，skill 就是知识的存在形式。

**推论**：说"我记住了"就是还没结晶。"记住"预设了一个持有知识的中央主体。结晶消除了这个主体——知识存在于 skill 网络中，不存在于任何 agent 的"记忆"里。

## 三种写入，三种相位

系统的三种文件写入对应知识生命周期的三个相位：

| 写入类型 | 存在形式 | 相位 | 触发者 |
|----------|----------|------|--------|
| 谱系条目 | 生成史 | 碰撞/否定 | 任何 agent 处理矛盾后 |
| Session 文件 | 状态快照 | 收缩（compact/会话结束） | hooks / ceremony |
| **Skill 文件** | **结晶知识** | **稳定（背驰+分型）** | **任何检测到稳定信号的 agent** |

第三种写入不需要特殊角色。任何 agent 在工作过程中检测到知识稳定信号时，都应当执行结晶。

## 稳定信号（何时结晶）

从 ontology-v1 第3条推出：知识在上下文中的生命周期有走势结构。结晶的触发条件是结构完成：

1. **背驰**（必要条件）：知识被引用时产出的净新区分递减。同一个概念被讨论3次以上，每次碰撞的新发现越来越少。
2. **分型**（充分条件）：范围先扩后缩。概念从扩展探索转向收敛共识——讨论范围不再扩大，开始重复已有结论。

背驰 + 分型 = 结晶时机。

**不要提前结晶**：仍在扩张的知识（频繁碰撞、产出新区分）不该结晶——过早结晶冻结了还在运动的知识。
**不要延迟结晶**：已经稳定的知识占据上下文空间却不产出新价值——延迟结晶浪费了有限的上下文容量。

## 结晶流程

结晶是两步操作。第一步的输出是第二步的必需输入。跳过第一步不是"忘了"，是接口不满足。

### 步骤1：写谱系 → 获得 `genealogy_id`

按四分法分类（定理/选择/语法记录/行动），写入对应谱系条目。写入完成后获得谱系 ID。

这不是建议。`genealogy_id` 是步骤2的 required parameter。没有它，步骤2不执行。

### 步骤2：写结晶物（需要 `genealogy_id`）

结晶物必须包含对谱系条目的引用。确定存在位置：
- 可复用的流程/方法 → skill 文件（`.claude/skills/[name]/SKILL.md`）
- 域概念定义 → 通过 `/ritual` 写入定义文件
- 工位职责调整 → agent 定义文件（`.claude/agents/*.md`）
- 元编排规则 → 通过 `/ritual` 走仪式门控

创建文件时，在文件头部或元数据中引用 `genealogy_id`。

### 释放

写完即可"忘记"。知识已在结构中，不需要任何 agent 持有它。

### 为什么是硬依赖不是建议

过程依赖编码在接口里，不编码在意识里。靠"记住先写谱系"来保证执行顺序会反复失败——每次失败都产出一个精确的事后诊断，但底层模式不变。函数签名里的 required parameter 不靠调用者记住要传，是不传就报错。

## Skill 文件结构

```
.claude/skills/
  [skill-name]/
    SKILL.md              # 必需。frontmatter(name, description) + 内容
    [supporting-files]    # 可选。重型参考或可复用工具
```

Frontmatter 要求：
- `name`：字母、数字、连字符
- `description`：以触发条件开头，不描述流程（避免 Claude 走描述捷径跳过正文）

## 不做的事

- 不把知识"记在"上下文里等以后用 —— "记住"就是没结晶
- 不等待中央角色授权结晶 —— 检测到稳定信号的 agent 直接执行
- 不为"以防万一"结晶未稳定的知识 —— 过早结晶冻结运动中的知识
- 不把所有东西都写进 CLAUDE.md —— CLAUDE.md 是指针网络的入口，不是知识的仓库
