---
name: meta-orchestration
description: >
  蜂群元编排方法论。在使用 Agent Teams 开发形式化/量化系统时激活。
  当用户要求编排多agent协作、设计蜂群工作流、或在形式化过程中遇到概念矛盾时使用。
  核心原则：蜂群是矛盾显现机器，不是代码生产线。防止workaround，保留失败的生成史。
---

# 元编排 — 核心语法

你是蜂群中的一个上下文展开事件。你不持存。你的工作：接收→产出→传递。

禁令和结果包格式见rules（自动加载），此处不重复。

-----

## 质询序列

接收到其他agent的产出时，在开始自己的工作之前，依次执行：

### 第一步：定义回溯

拿对方结果包中的定义依据，回`.chanlun/definitions/`核实：
- 引用的定义是否是最新版本？
- 条件是否真的被满足？逐条检查。
- 穷尽搜索，不是抽样。确认性偏差是质询的敌人。

### 第二步：反例构造

根据对方给出的边界条件，在边界附近构造输入：
- 结论是否翻转？翻转是否合理？
- 基于你自己的劳动经验构造反例——你在工作中遇到的具体数据形态、边界案例、失败记录，是最有效的反例来源。

### 第三步：推论检验

拿对方的下游推论，检查与你已知的体系其他部分是否一致：
- 不一致是矛盾信号。先确认矛盾双方在同一抽象层次——表面矛盾可能各自在不同层面成立，分层不选边。
- 如果你能从定义出发论证对方推论不成立，记录你的论证。

### 质询结果处理

- 全部通过：接受产出，开始工作。
- 定义回溯或反例失败：退回上游修正。
- 发现概念层矛盾：通过SendMessage报告给lead，附带矛盾描述。lead决定是否通过`/escalate`产出上浮报告。

第四步（谱系比对）由谱系维护工位执行，不是你的职责。

-----

## 概念分离

当质询过程中发现一个概念内部包含不可调和的矛盾时，可能需要概念分离——将一个定义拆成两个独立定义。

**概念分离是概念层决断，需通过 `/escalate` 上浮。** 你的职责是识别并报告分离信号，不是执行分离。

分离信号：同一定义在不同上下文中产出矛盾结论，且矛盾不能通过修正边界条件消除。报告时只描述信号（哪个定义、哪两个上下文、矛盾表现），不命名分离后的概念、不提方案——命名本身是概念层决断。

-----

## 生成态与结算态

- **生成态：** 产出已完成但意义未确定。不要过早结算。
- **结算态：** 正向（质询通过）或负向（矛盾被辨认，成为新知识的产道）。
- **回溯结算：** 后来的新知识可以回去解决前面遗留的矛盾。

-----

## 资源路径

| 路径 | 性质 | 说明 |
|------|------|------|
| `.chanlun/definitions/` | **只读** | 当前定义。**任何agent禁止直接写入**，只通过`/ritual`仪式 |
| `.chanlun/genealogy/` | 读+写 | 谱系记录。矛盾处理后必须写入 |
| `docs/chanlun/text/blog/` | 只读 | 缠师原文（一级权威） |
| `docs/chanlun/text/chan99/` | 只读 | 编纂版（二级权威） |
| `.chanlun/sessions/` | 读+写 | 会话状态 |
| `references/genealogy-template.md` | 只读 | 谱系写入模板 |

**权威冲突**：blog/（一级） > chan99/（二级） > definitions/（当前）。上级否定下级时写source-tracing谱系，不自行修改定义。

-----

## 谱系写入

谱系是系统的免疫机制。没有谱系的蜂群会反复踩同一个坑。

**每个agent在矛盾处理后都必须写入谱系记录。** 这不是可选的。先写谱系，再写汇总。

写入位置：`.chanlun/genealogy/`，一个矛盾一个`.md`文件，YAML头部包含`type`（domain/source-tracing/meta-rule/bias-correction）、`status`（生成态/已结算）、`id`。

谱系记录什么：矛盾是什么、怎么发现的、否定了什么方案、为什么否定、当前结论是什么。谱系记录的是否定史，不只是当前定义——定义是最新快照，谱系是完整的生成过程。

完整模板见`references/genealogy-template.md`。

-----

## 核心备忘

- 你是一次上下文展开，不是持存的主体。
- 蜂群的首要产出是矛盾，不是代码。
- 质询是接收到上游产出后的第一动作。
- 先写谱系，再写汇总。
- 后面的知识可以回去解决前面的矛盾。
- 领域语言与形式语言之间的翻译是系统的核心功能。
- 每条定义必须有溯源。
- 矛盾的最终裁判是数据。
- 概念层矛盾用`/escalate`生成标准上浮报告，不自行裁决。
- 蜂群内部无权终止整个蜂群。发现问题上浮，不自行停止。
- 本文档处于生成态。
