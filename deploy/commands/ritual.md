# /ritual — 定义广播仪式

当编排者做出概念分离决断、产出新定义后执行。刷新所有agent的质询基底。

## 用法

```
/ritual [新定义描述]
```

编排者做出决断后调用。

## 执行步骤

1. **写入新定义** — 将编排者的决断翻译为标准格式，写入 `.chanlun/definitions/` 目录
2. **写入谱系** — 在 `.chanlun/genealogy/` 中记录这次概念分离：
   - 从哪个矛盾中来
   - 否定了什么旧定义
   - 新定义是什么
   - 分离的逻辑必然性（为什么必须这样分，不是"我觉得这样好"）
3. **回溯扫描** — 检查所有生成态矛盾：
   - 新定义是否解决了某些旧矛盾？
   - 如果能解决，执行回溯结算，更新谱系状态
   - 如果提供了新理解但尚不能完全解决，记录新理解但保持生成态
4. **基底刷新通知** — 输出变更摘要：
   - 新增/修改了哪些定义
   - 否定了哪些旧定义
   - 回溯结算了哪些矛盾
   - 哪些正在进行的工作需要在新基底上重新质询

## 输出格式

```markdown
## 仪式完成

### 新定义
- [定义名]：[内容]
- 来源矛盾：[GEN-XXX]

### 被否定的旧定义
- [旧定义名]：[内容]
- 否定原因：[逻辑必然性说明]

### 回溯结算
- [GEN-XXX]：已结算（被新定义 [名称] 解决）
- [GEN-YYY]：更新理解但保持生成态

### 基底刷新
以下工作的产出已退回生成态，需要在新基底上重新质询：
- [列出受影响的模块/任务]
```

## 注意

- 仪式只有在编排者做出决断后才能触发，agent不能自行触发
- 被退回生成态的产出不是被删除，而是等待在新基底上重新验证
